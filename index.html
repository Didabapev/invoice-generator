<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Invoice Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      padding: 40px;
    }
    h1 { text-align: center; }
    .container {
      background: #fff;
      max-width: 700px;
      margin: auto;
      padding: 20px;
      border-radius: 8px;
    }
    input {
      padding: 8px;
      margin-bottom: 8px;
    }
    .row { display: flex; gap: 10px; }
    .row input { flex: 1; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background: #f0f0f0; }
    button {
      margin-top: 10px;
      padding: 10px;
      background: #000;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    .add-btn { background: #444; }
  </style>
</head>
<body>
<h1>Invoice Generator</h1>

<div class="container">
  <input id="invoiceNumber" placeholder="Invoice Number" />

  <div class="row">
    <input id="invoiceDate" type="date" />
    <input id="dueDate" type="date" />
  </div>

  <input id="billFrom" placeholder="Bill From (Your Company)" />
  <input id="clientName" placeholder="Bill To (Client Name)" />

  <table id="items">
    <thead>
      <tr>
        <th>Description</th>
        <th>Qty</th>
        <th>Unit Price</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input /></td>
        <td><input type="number" value="1" /></td>
        <td><input type="number" value="0" /></td>
        <td class="line-total">0</td>
      </tr>
    </tbody>
  </table>

  <button class="add-btn" onclick="addItem()">Add Item</button>

  <input id="tax" type="number" placeholder="Tax % (e.g. 10)" />

  <button onclick="generateInvoice()">Generate Invoice (PDF)</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
function addItem() {
  const table = document.querySelector('#items tbody');
  const row = document.createElement('tr');
  row.innerHTML = `
    <td><input /></td>
    <td><input type="number" value="1" /></td>
    <td><input type="number" value="0" /></td>
    <td class="line-total">0</td>`;
  table.appendChild(row);
}

function calculateTotals() {
  let subtotal = 0;
  document.querySelectorAll('#items tbody tr').forEach(row => {
    const qty = Number(row.children[1].querySelector('input').value);
    const price = Number(row.children[2].querySelector('input').value);
    const total = qty * price;
    row.querySelector('.line-total').innerText = total.toFixed(2);
    subtotal += total;
  });
  return subtotal;
}

function generateInvoice() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const invoiceNumber = document.getElementById('invoiceNumber').value;
  const invoiceDate = document.getElementById('invoiceDate').value;
  const dueDate = document.getElementById('dueDate').value;
  const billFrom = document.getElementById('billFrom').value;
  const clientName = document.getElementById('clientName').value;
  const taxRate = Number(document.getElementById('tax').value) || 0;

  const subtotal = calculateTotals();
  const taxAmount = subtotal * taxRate / 100;
  const total = subtotal + taxAmount;

  doc.setFontSize(16);
  doc.text('INVOICE', 20, 20);

  doc.setFontSize(11);
  doc.text(`Invoice #: ${invoiceNumber}`, 20, 35);
  doc.text(`Invoice Date: ${invoiceDate}`, 20, 42);
  doc.text(`Due Date: ${dueDate}`, 20, 49);

  doc.text('Bill From:', 20, 65);
  doc.text(billFrom, 20, 72);
  doc.text('Bill To:', 20, 85);
  doc.text(clientName, 20, 92);

  let y = 110;
  doc.text('Items:', 20, y);
  y += 8;

  document.querySelectorAll('#items tbody tr').forEach(row => {
    const desc = row.children[0].querySelector('input').value;
    const qty = row.children[1].querySelector('input').value;
    const price = row.children[2].querySelector('input').value;
    const line = row.querySelector('.line-total').innerText;
    doc.text(`${desc} | ${qty} x $${price} = $${line}`, 20, y);
    y += 7;
  });

  y += 10;
  doc.text(`Subtotal: $${subtotal.toFixed(2)}`, 20, y);
  y += 7;
  doc.text(`Tax (${taxRate}%): $${taxAmount.toFixed(2)}`, 20, y);
  y += 7;
  doc.text(`Total: $${total.toFixed(2)}`, 20, y);

  doc.save(`invoice-${invoiceNumber}.pdf`);
}
</script>
</body>
</html>
